{% extends "base.html" %}
{% block title %}Query{% endblock %}
{% block header %}
    {% if state is not none %}
    <li>{{ state }}</li>
    {% endif %}
{% endblock %}
{% block content %}
    {% if readme is not none %}
    <div>{{ readme }}</div>
    {% else %}
    <h1>Gitbi Home</h1>
    <p>[Readme file is missing]</p>
    {% endif %}
    <h2>Commits</h2>
    <table>
        <tr><th>Commit</th><th>Date</th><th>Message</th></tr>
        {% for commit in commits %}
        <tr>
            <th><a href="{{ url_for('home_route', state=commit.hash) }}">{{ commit.hash|e }}</a></th>
            <th>{{ commit.date|e }}</th>
            <th>{{ commit.msg|e }}</th>
        </tr>
        {% endfor %}
    </table>
    <h2>Data sources:</h2>
    {% for db, files in databases.items() %}
        <h3>{{ db|e }}</h3>
        <p><a href="{{ url_for('db_route', state=state, db=db) }}">List tables</a></p>
        <p><a href="{{ url_for('query_route', db=db) }}">New query</a></p>
        <ul>
        {% for file in files %}
        <li><a href="{{ url_for('saved_query_route', state=state, db=db, file=file) }}">{{ file|e }}</a></li>
        {% endfor %}
        </ul>
    {% endfor %}
{% endblock %}
