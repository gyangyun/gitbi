{% extends "base.html" %}
{% block title %}Home{% endblock %}
{% block content %}
    {% if readme is not none %}
    <div>{{ readme }}</div>
    {% else %}
    <h1>Gitbi Home</h1>
    <p>[Readme file is missing]</p>
    {% endif %}
    <h2>Data Sources</h2>
    {% for db, files in databases.items() %}
    <p>
        <span class="db"><strong>{{ db|e }}</strong></span> | 
        <a href="{{ request.app.url_path_for('query_route', db=db) }}">New query</a>
    </p>
    <a
        class="hidden"
        hx-get="{{ request.app.url_path_for('tables_route', db=db) }}"
        hx-trigger="load"
        hx-target="#db-details-{{ db }}"
        hx-swap="beforeend"
    >
        Load table info
    </a>
    <details>
        <summary>Queries</summary>
        <ul>
            {% for file in files %}
            <li><a href="{{ request.app.url_path_for('saved_query_route', state=state, db=db, file=file) }}">{{ file|e }}</a></li>
            {% endfor %}
        </ul>
    </details>
    <details id="db-details-{{ db }}">
        <summary>Tables</summary>
    </details>
    <br>
    {% endfor %}
{% endblock %}
